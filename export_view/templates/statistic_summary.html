{% extends "layout_statistic.html" %}
{% block title %}Th·ªëng k√™ Nh·∫≠p/Xu·∫•t kho{% endblock %}

{% block content %}
  
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
    }

    h2, h3 {
      color: #0d47a1;
    }

    form {
      margin-bottom: 20px;
      background: #e0f7fa;
      padding: 15px;
      border-radius: 8px;
    }

    label {
      margin-right: 10px;
      font-weight: bold;
    }

    select, input[type=number], button {
      margin-right: 20px;
      padding: 5px 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      padding: 8px 12px;
      border: 1px solid #ccc;
    }

    th {
      background-color: #f0f0f0;
    }

    .back-link {
      margin-top: 30px;
      display: inline-block;
    }
  </style>
  <script>
    function toggleMonthField() {
      var mode = document.querySelector('select[name="mode"]').value;
      var monthInput = document.getElementById("month-input");
      monthInput.style.display = (mode === 'month') ? 'inline-block' : 'none';
    }
    window.onload = toggleMonthField;
  </script>
</head>
<body>
  <h2 style="text-align: center;">üìã TH√îÃÅNG K√ä XU√ÇÃÅT KHO - NH√ÇÃ£P KHO</h2>

   <form method="POST">
    <label>Ch·∫ø ƒë·ªô:</label>
    <select name="mode" onchange="toggleMonthField()">
      <option value="month" {% if mode == 'month' %}selected{% endif %}>Theo th√°ng</option>
      <option value="year" {% if mode == 'year' %}selected{% endif %}>Theo nƒÉm</option>
    </select>

    <label>Lo·∫°i:</label>
    <select name="item_type">
      <option value="material" {% if item_type == 'material' %}selected{% endif %}>V·∫≠t t∆∞</option>
      <option value="chemical" {% if item_type == 'chemical' %}selected{% endif %}>H√≥a ch·∫•t</option>
    </select>

    <label>Ki·ªÉu:</label>
    <select name="action_type">
      <option value="import" {% if action_type == 'import' %}selected{% endif %}>Nh·∫≠p kho</option>
      <option value="export" {% if action_type == 'export' %}selected{% endif %}>Xu·∫•t kho</option>
    </select>

    <label id="month-input">Th√°ng:
      <input type="number" name="month" min="1" max="12" value="{{ month }}">
    </label>

    <label>NƒÉm:</label>
    <input type="number" name="year" value="{{ year }}">

    <button type="submit">Xem th·ªëng k√™</button>
    <button type="submit" name="export_excel" value="1">Xu·∫•t Excel</button>
  </form>

  {% if df is not none and df|length > 0 %}
    <h3>{{ "üì•" if action_type == 'import' else "üì§" }} {{ label }}</h3>
    <table>
      <thead>
        <tr>
          <th>T√™n v·∫≠t t∆∞</th>
          <th>T√™n SAP</th>
          <th>M√£ SAP</th>
          <th>ƒê∆°n v·ªã</th>
          <th>{{ label }}</th>
        </tr>
      </thead>
      <tbody>
        {% for index, row in df.iterrows() %}
        <tr>
          <td>{{ row["T√™n"] }}</td>
          <td>{{ row["T√™n SAP"] }}</td>
          <td>{{ row["M√£ SAP"] }}</td>
          <td>{{ row["ƒê∆°n v·ªã"] }}</td>
          <td>{{ row[label] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p><em>Kh√¥ng c√≥ d·ªØ li·ªáu cho l·ª±a ch·ªçn n√†y.</em></p>
  {% endif %}

  <a class="back-link" href="{{ url_for('dashboard.index') }}">‚¨Ö Quay l·∫°i trang ch√≠nh</a>

{% endblock %}
